<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Results Reproducibility • cape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Results Reproducibility">
<meta property="og:description" content="cape">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pkgdown.html">Get started</a>
</li>
<li>
  <a href="../articles/reproducibility.html">Reproducibility</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stephaneguerrier/cape">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="reproducibility_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Results Reproducibility</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stephaneguerrier/cape/blob/master/vignettes/reproducibility.Rmd"><code>vignettes/reproducibility.Rmd</code></a></small>
      <div class="hidden name"><code>reproducibility.Rmd</code></div>

    </div>

    
    
<div id="case-study-application-to-austrian-covid-19-survey" class="section level1">
<h1 class="hasAnchor">
<a href="#case-study-application-to-austrian-covid-19-survey" class="anchor"></a>Case study: Application to Austrian COVID-19 survey</h1>
<p>We use the methodology developed in this paper for the case of the COVID-19 prevalence estimation using the results of a survey done in November 2020 by <span class="citation">Statistics Austria (2020)</span>. We also compare the different approaches, in order to illustrate, in practice, the impact of choosing one method rather than another one. In November 2020, a survey sample of <span class="math inline">\(n=2287\)</span> was collected to test for COVID-19 using PCR-tests. Seventy-one participants were tested positive, and among these ones, thirty-two (<span class="math inline">\(R_1=32\)</span>) had declared to have been tested positive with the official procedure, during the same month. In November, there were <span class="math inline">\(93914\)</span> declared cases among the official (approximately) <span class="math inline">\(7166167\)</span> inhabitants in Austria (above 16 years old), so that <span class="math inline">\(\pi_0 \approx 1.3105\%\)</span>. The sensitivity (<span class="math inline">\(1-\alpha\)</span>) and the specificity (<span class="math inline">\(1-\beta\)</span>) are not known with precision, so that we present estimates of the prevalence without misclassification error as well as for values for the FP and FN rates, that are plausible given the data and according to the sensitivity and specificity reported in  or .</p>
<p>The results presented in Table 1 of <span class="citation">Guerrier, Kuzmics, and Victoria-Feser (2020)</span> can be reproduced as follows:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># Load cape</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cape</span>)

<span class="co"># Austrian data (November 2020)</span>
<span class="no">pi0</span> <span class="kw">=</span> <span class="fl">93914</span>/<span class="fl">7166167</span>
<span class="no">n</span> <span class="kw">=</span> <span class="fl">2287</span>
<span class="no">R1</span> <span class="kw">=</span> <span class="fl">32</span>
<span class="no">R2</span> <span class="kw">=</span> <span class="fl">0</span>
<span class="no">R3</span> <span class="kw">=</span> <span class="fl">39</span>
<span class="no">R4</span> <span class="kw">=</span> <span class="no">n</span> - <span class="no">R1</span> - <span class="no">R2</span> - <span class="no">R3</span>

<span class="co"># Meas. error</span>
<span class="no">alpha0</span> <span class="kw">=</span> <span class="fl">0</span>
<span class="no">alpha</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">100</span>
<span class="no">beta</span> <span class="kw">=</span> <span class="fl">10</span>/<span class="fl">100</span>

<span class="co"># Fit survey MLE (no meas. error)</span>
<span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">R1</span> + <span class="no">R3</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>)</pre></body></html></div>
<pre><code>## Method: Survey MLE
## 
## Estimated proportion: 3.1045%
## Standard error      : 0.3627%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 2.3937% - 3.8153%
## Clopper-Pearson    : 2.4324% - 3.8999%
## 
## Assumed measurement error: alpha = 0%, beta = 0%</code></pre>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Fit survey MLE (with meas. error)</span>
<span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">R1</span> + <span class="no">R3</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>)</pre></body></html></div>
<pre><code>## Method: Survey MLE
## 
## Estimated proportion: 2.3646%
## Standard error      : 0.4075%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 1.5659% - 3.1633%
## Clopper-Pearson    : 1.6095% - 3.2584%
## 
## Assumed measurement error: alpha = 1%, beta = 10%</code></pre>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># Conditional MLE (no meas. error)</span>
<span class="fu"><a href="../reference/conditional_mle.html">conditional_mle</a></span>(<span class="kw">R1</span> <span class="kw">=</span> <span class="no">R1</span>, <span class="kw">R2</span> <span class="kw">=</span> <span class="no">R2</span>, <span class="kw">R3</span> <span class="kw">=</span> <span class="no">R3</span>, <span class="kw">R4</span> <span class="kw">=</span> <span class="no">R4</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>)</pre></body></html></div>
<pre><code>## Method: Conditional MLE
## 
## Estimated proportion: 3.0171%
## Standard error      : 0.2708%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 2.4864% - 3.5479%
## 
## Assumed measurement error: alpha  = 0%, beta = 0%,
##                            alpha0 = 0% 
## 
## Estimated false negative rate of the
## official procedure: beta0 = 56.564%</code></pre>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># Conditional MLE (with meas. error)</span>
<span class="fu"><a href="../reference/conditional_mle.html">conditional_mle</a></span>(<span class="kw">R1</span> <span class="kw">=</span> <span class="no">R1</span>, <span class="kw">R2</span> <span class="kw">=</span> <span class="no">R2</span>, <span class="kw">R3</span> <span class="kw">=</span> <span class="no">R3</span>, <span class="kw">R4</span> <span class="kw">=</span> <span class="no">R4</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>,
                <span class="kw">alpha0</span> <span class="kw">=</span> <span class="no">alpha0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>)</pre></body></html></div>
<pre><code>## Method: Conditional MLE
## 
## Estimated proportion: 2.1195%
## Standard error      : 0.3043%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 1.5231% - 2.7159%
## 
## Assumed measurement error: alpha  = 1%, beta = 10%,
##                            alpha0 = 0% 
## 
## Estimated false negative rate of the
## official procedure: beta0 = 38.1681%</code></pre>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># Moment estimator (no meas. error)</span>
<span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span>(<span class="kw">R3</span> <span class="kw">=</span> <span class="no">R3</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>)</pre></body></html></div>
<pre><code>## Method: Moment Estimator
## 
## Estimated proportion: 3.0158%
## Standard error      : 0.2707%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 2.4852% - 3.5464%
## Clopper-Pearson    : 2.5259% - 3.6344%
## 
## Assumed measurement error: alpha  = 0%, beta = 0%,
##                            alpha0 = 0% 
## 
## Estimated false negative rate of the
## official procedure: beta0 = 56.545%</code></pre>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># Moment estimator (with meas. error)</span>
<span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span>(<span class="kw">R3</span> <span class="kw">=</span> <span class="no">R3</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>,
                 <span class="kw">alpha0</span> <span class="kw">=</span> <span class="no">alpha0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>)</pre></body></html></div>
<pre><code>## Method: Moment Estimator
## 
## Estimated proportion: 2.1177%
## Standard error      : 0.3042%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 1.5215% - 2.7139%
## Clopper-Pearson    : 1.5672% - 2.8127%
## 
## Assumed measurement error: alpha  = 1%, beta = 10%,
##                            alpha0 = 0% 
## 
## Estimated false negative rate of the
## official procedure: beta0 = 38.1161%</code></pre>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># Fit survey MLE (no meas. error) with increased sample size k = 1.5</span>
<span class="no">k</span> <span class="kw">=</span> <span class="fl">1.5</span>
<span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">k</span>*(<span class="no">R1</span> + <span class="no">R3</span>)), <span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">k</span>*<span class="no">n</span>), <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>)</pre></body></html></div>
<pre><code>## Method: Survey MLE
## 
## Estimated proportion: 3.1186%
## Standard error      : 0.2968%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 2.5370% - 3.7002%
## Clopper-Pearson    : 2.5627% - 3.7562%
## 
## Assumed measurement error: alpha = 0%, beta = 0%</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="co"># Fit survey MLE (with meas. error) with increased sample size k = 1.5</span>
<span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">k</span>*(<span class="no">R1</span> + <span class="no">R3</span>)), <span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">k</span>*<span class="no">n</span>), <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>,
                       <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>)</pre></body></html></div>
<pre><code>## Method: Survey MLE
## 
## Estimated proportion: 2.3805%
## Standard error      : 0.3334%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 1.7270% - 3.0340%
## Clopper-Pearson    : 1.7558% - 3.0969%
## 
## Assumed measurement error: alpha = 1%, beta = 10%</code></pre>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># Fit survey MLE (no meas. error) with increased sample size k = 2</span>
<span class="no">k</span> <span class="kw">=</span> <span class="fl">2</span>
<span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">k</span>*(<span class="no">R1</span> + <span class="no">R3</span>)), <span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">k</span>*<span class="no">n</span>), <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>)</pre></body></html></div>
<pre><code>## Method: Survey MLE
## 
## Estimated proportion: 3.1045%
## Standard error      : 0.2564%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 2.6019% - 3.6071%
## Clopper-Pearson    : 2.6211% - 3.6490%
## 
## Assumed measurement error: alpha = 0%, beta = 0%</code></pre>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># Fit survey MLE (with meas. error) with increased sample size k = 2</span>
<span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">k</span>*(<span class="no">R1</span> + <span class="no">R3</span>)), <span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">k</span>*<span class="no">n</span>), <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>,
                       <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>)</pre></body></html></div>
<pre><code>## Method: Survey MLE
## 
## Estimated proportion: 2.3646%
## Standard error      : 0.2881%
## 
## Confidence intervals at the 95% level:
## Asymptotic Approach: 1.7999% - 2.9294%
## Clopper-Pearson    : 1.8214% - 2.9764%
## 
## Assumed measurement error: alpha = 1%, beta = 10%</code></pre>
<p>Moreover, Figure 1 can be obtained by running the file <code>cape/figures/case_study.Rnw</code>. A base R version can be obtained as follows:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># Austrian data (November 2020)</span>
<span class="no">pi0</span> <span class="kw">=</span> <span class="fl">93914</span>/<span class="fl">7166167</span>
<span class="no">n</span> <span class="kw">=</span> <span class="fl">2287</span>
<span class="no">R1</span> <span class="kw">=</span> <span class="fl">32</span>
<span class="no">R2</span> <span class="kw">=</span> <span class="fl">0</span>
<span class="no">R3</span> <span class="kw">=</span> <span class="fl">39</span>
<span class="no">R4</span> <span class="kw">=</span> <span class="no">n</span> - <span class="no">R1</span> - <span class="no">R2</span> - <span class="no">R3</span>

<span class="co"># Assumptions</span>
<span class="no">pi0</span> <span class="kw">=</span> <span class="fl">0.013105</span>
<span class="no">alpha</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="fl">100</span>
<span class="no">alpha0</span> <span class="kw">=</span> <span class="fl">0</span>
<span class="no">m</span> <span class="kw">=</span> <span class="fl">300</span>
<span class="no">beta</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="no">m</span>)/<span class="fl">100</span>
<span class="no">res_moment</span> <span class="kw">=</span> <span class="no">res_cmle</span> <span class="kw">=</span> <span class="no">res_umle</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>, <span class="no">m</span>, <span class="fl">5</span>)

<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">m</span>){
  <span class="co"># Moment estimator</span>
  <span class="no">inter</span> <span class="kw">=</span> <span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span>(<span class="kw">R3</span> <span class="kw">=</span> <span class="no">R3</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>,
                           <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">alpha0</span> <span class="kw">=</span> <span class="no">alpha0</span>,
                           <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>[<span class="no">i</span>])
  <span class="no">inter2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span>(<span class="kw">R3</span> <span class="kw">=</span> <span class="no">R3</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>,
                            <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">alpha0</span> <span class="kw">=</span> <span class="no">alpha0</span>,
                            <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>[<span class="no">i</span>], <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">0.2</span>)
  <span class="no">res_moment</span>[<span class="no">i</span>,] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">inter</span>$<span class="no">estimate</span>, <span class="no">inter</span>$<span class="no">ci_cp</span>, <span class="no">inter2</span>$<span class="no">ci_cp</span>)

  <span class="co"># Conditional MLE</span>
  <span class="no">inter</span> <span class="kw">=</span> <span class="fu"><a href="../reference/conditional_mle.html">conditional_mle</a></span>(<span class="kw">R1</span> <span class="kw">=</span> <span class="no">R1</span>, <span class="kw">R2</span> <span class="kw">=</span> <span class="no">R2</span>, <span class="kw">R3</span> <span class="kw">=</span> <span class="no">R3</span>, <span class="kw">R4</span> <span class="kw">=</span> <span class="no">R4</span>,
                          <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">alpha0</span> <span class="kw">=</span> <span class="no">alpha0</span>,
                          <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>[<span class="no">i</span>])
  <span class="no">inter2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/conditional_mle.html">conditional_mle</a></span>(<span class="kw">R1</span> <span class="kw">=</span> <span class="no">R1</span>, <span class="kw">R2</span> <span class="kw">=</span> <span class="no">R2</span>, <span class="kw">R3</span> <span class="kw">=</span> <span class="no">R3</span>, <span class="kw">R4</span> <span class="kw">=</span> <span class="no">R4</span>,
                           <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">alpha0</span> <span class="kw">=</span> <span class="no">alpha0</span>,
                           <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>[<span class="no">i</span>], <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">0.2</span>)
  <span class="no">res_cmle</span>[<span class="no">i</span>,] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">inter</span>$<span class="no">estimate</span>, <span class="no">inter</span>$<span class="no">ci_asym</span>, <span class="no">inter2</span>$<span class="no">ci_asym</span>)

  <span class="co"># Survey MLE</span>
  <span class="no">inter</span> <span class="kw">=</span> <span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">R1</span> + <span class="no">R3</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>,
                     <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">alpha0</span> <span class="kw">=</span> <span class="no">alpha0</span>,
                     <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>[<span class="no">i</span>])
  <span class="no">inter2</span> <span class="kw">=</span> <span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">R1</span> + <span class="no">R3</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">pi0</span> <span class="kw">=</span> <span class="no">pi0</span>,
                      <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">alpha0</span> <span class="kw">=</span> <span class="no">alpha0</span>,
                      <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>[<span class="no">i</span>], <span class="kw">gamma</span> <span class="kw">=</span> <span class="fl">0.2</span>)
  <span class="no">res_umle</span>[<span class="no">i</span>,] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">inter</span>$<span class="no">estimate</span>, <span class="no">inter</span>$<span class="no">ci_cp</span>, <span class="no">inter2</span>$<span class="no">ci_cp</span>)
}

<span class="no">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#F8766DFF"</span>, <span class="st">"#00BFC4FF"</span>)
<span class="no">cols2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#F8766D1F"</span>, <span class="st">"#00BFC41F"</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="fl">NA</span>, <span class="kw">xlim</span> <span class="kw">=</span> <span class="fl">100</span>*<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="no">beta</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">4.5</span>), <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">beta</span>, <span class="st">" (%)"</span>)), <span class="kw">side</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.15</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="st">"Prevalence (%)"</span>, <span class="kw">side</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.15</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span> <span class="kw">=</span> <span class="fl">100</span>*<span class="no">pi0</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="fl">2.5</span>, <span class="fl">1.18</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">pi</span>[<span class="fl">0</span>]), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.15</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MME"</span>, <span class="st">"95% CI"</span>,
                     <span class="st">"Survey MLE"</span>, <span class="st">"95% CI"</span>),
       <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">cols</span>[<span class="fl">1</span>], <span class="no">cols2</span>[<span class="fl">1</span>],<span class="no">cols</span>[<span class="fl">2</span>], <span class="no">cols2</span>[<span class="fl">2</span>]),
       <span class="kw">lwd</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">NA</span>, <span class="fl">3</span>, <span class="fl">NA</span>), <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">NA</span>, <span class="fl">15</span>, <span class="fl">NA</span>, <span class="fl">15</span>),
       <span class="kw">pt.cex</span> <span class="kw">=</span> <span class="fl">2.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="fl">100</span>*<span class="no">beta</span>, <span class="fl">100</span>*<span class="no">res_moment</span>[,<span class="fl">1</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">cols</span>[<span class="fl">1</span>])
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span>(<span class="fl">100</span>*<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="no">beta</span>)),
        <span class="fl">100</span>*<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">res_moment</span>[,<span class="fl">2</span>], <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="no">res_moment</span>[,<span class="fl">3</span>])),
        <span class="kw">col</span> <span class="kw">=</span> <span class="no">cols2</span>[<span class="fl">1</span>], <span class="kw">border</span> <span class="kw">=</span> <span class="fl">NA</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="fl">100</span>*<span class="no">beta</span>, <span class="fl">100</span>*<span class="no">res_umle</span>[,<span class="fl">1</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">cols</span>[<span class="fl">2</span>])
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span>(<span class="fl">100</span>*<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="no">beta</span>)),
        <span class="fl">100</span>*<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">res_umle</span>[,<span class="fl">2</span>], <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="no">res_umle</span>[,<span class="fl">3</span>])),
        <span class="kw">col</span> <span class="kw">=</span> <span class="no">cols2</span>[<span class="fl">2</span>], <span class="kw">border</span> <span class="kw">=</span> <span class="fl">NA</span>)</pre></body></html></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-2-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="simulation-study" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-study" class="anchor"></a>Simulation Study</h1>
<p>The results summarized in Section 3.4 and presented in Appendix D of <span class="citation">Guerrier, Kuzmics, and Victoria-Feser (2020)</span> can be replicated as follows:</p>
<ol style="list-style-type: decimal">
<li>Run the file <code>cape/simulations/simulation_script.R</code> which should take a couple of hours on a standard laptop and generate the file <code>cape/simulations/simulations.RData</code>.</li>
<li>Run the file <code>cape/simulations/figures.Rnw</code> (which reads <code>cape/simulations/simulations.RData</code>) to generates Figures 2, 3 and 4 (as well as color versions of these figures).</li>
</ol>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-guerrier2020prevalence">
<p>Guerrier, Stéphane, Christoph Kuzmics, and Maria-Pia Victoria-Feser. 2020. “Prevalence Estimation from Random Samples and Census Data with Participation Bias.” <a href="http://arxiv.org/abs/2012.10745">http://arxiv.org/abs/2012.10745</a>.</p>
</div>
<div id="ref-StatAU20">
<p>Statistics Austria. 2020. “Prävalenz von SARS-CoV-2-Infektionen liegt bei 3,1%.” <a href="https://www.statistik.at/web_de/presse/124846.html">https://www.statistik.at/web_de/presse/124846.html</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Stéphane Guerrier, Maria-Pia Victoria-Feser, Christoph Kuzmics, Mucyo Karemera.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
